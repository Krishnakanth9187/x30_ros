name: Deploy to Robot

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: [self-hosted, Linux, X64]
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up ROS 2
        run: source /opt/ros/humble/setup.bash

      - name: Build and Deploy
        run: |
          mkdir -p strider_ws/src
          rsync -a --exclude=strider_ws --exclude=.git ./ strider_ws/src/
          cd strider_ws
          rosdep update
          rosdep install --from-paths src --ignore-src -r -y
          colcon build --symlink-install

